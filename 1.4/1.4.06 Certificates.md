## 1. What is in a Digital Certificate? (X.509)

The **X.509** is the standard format for public key certificates. It contains the public key and the identity of the owner, all signed by a trusted third party.

### Standard Certificate Details:

* **Version Number:** Identifies which X.509 version is used.
* **Serial Number:** A unique identifier assigned by the CA.
* **Signature Algorithm:** The algorithm used to sign the certificate (e.g., `sha256RSA`).
* **Issuer:** The Certificate Authority (CA) that issued the certificate.
* **Validity Period:** The "Not Before" and "Not After" dates.
* **Subject:** The entity the certificate belongs to (e.g., `CN=www.example.com`).
* **Public Key:** The actual public key and its algorithm.
* **Extensions:** Additional attributes like **Subject Alternative Name (SAN)**, which allows one certificate to protect multiple domains.

---

## 2. The Hierarchy: Root of Trust & CAs

Trust in PKI is hierarchical. If you trust the person at the top, you trust everyone they vouch for.

* **Root of Trust:** The foundation of the PKI. It is represented by a **Root Certificate** that is self-signed. Your OS and Browser come pre-installed with a "Root Store" of trusted root certificates.
* **Certificate Authority (CA):** The entity that issues digital certificates.
* **Third-Party (Public) CA:** Trusted by everyone (e.g., DigiCert, Let's Encrypt). Used for public websites.
* **Private (Internal) CA:** An organization sets up its own CA to issue certificates for internal servers and employees. These are not trusted by the outside world.


* **Intermediate CA:** To protect the Root CA, it is often kept offline. It issues certificates to "Intermediate CAs," which then issue the end-user certificates.

---

## 3. Special Certificate Types

* **Self-Signed Certificate:** Signed by the same entity it identifies. It provides encryption but **no third-party validation**. Great for testing, but browsers will show a "Not Secure" warning.
* **Wildcard Certificate:** Protects a domain and all its subdomains (e.g., `*.example.com` covers `mail.example.com` and `blog.example.com`).
* **SAN (Subject Alternative Name):** Allows multiple specific domains to be listed on one certificate (e.g., `example.com` and `example.net`).

---

## 4. The Certificate Lifecycle

1. **Key Pair Generation:** The user generates a Public and Private key.
2. **CSR (Certificate Signing Request):** The user sends their **Public Key** and identity info to a CA. (The Private Key **never** leaves the user's possession).
3. **Issuance:** The CA verifies the identity and signs the certificate.

---

## 5. Revocation: When Trust Ends

If a private key is stolen or an employee leaves, a certificate must be cancelled before it expires.

| Method | Description | Pros/Cons |
| --- | --- | --- |
| **CRL (Cert. Revocation List)** | A list of serial numbers for revoked certificates published by the CA. | **Con:** Can get very large; browsers must download the whole list. |
| **OCSP (Online Cert. Status Protocol)** | The browser asks the CA in real-time: "Is this specific serial number still valid?" | **Pro:** Faster than CRL. **Con:** Adds "latency" to the connection. |
| **OCSP Stapling** | The web server downloads the OCSP status from the CA and "staples" it to the certificate during the handshake. | **Pro:** Fastest and most private method. No direct browser-to-CA communication. |

---

## Summary for the Exam

* **Trusting a site:** Your browser checks if the certificate was signed by a **Root CA** in its local store.
* **Revocation:** If you need the *fastest* way to check if a cert is revoked, use **OCSP Stapling**.
* **CSR:** This contains your **Public Key**; you send it to the CA to get a certificate.
* **Wildcard:** Use this to save money if you have dozens of subdomains like `dev.site.com`, `test.site.com`, etc.
